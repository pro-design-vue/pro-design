<script setup lang="tsx">
import { sleep } from '@pro-design-vue/utils'
import { message } from 'ant-design-vue'
import { ProFieldType, ProForm, type ProFormItemType } from 'pro-design-vue'
import { ref } from 'vue'

const LAYOUT_TYPE_HORIZONTAL = 'horizontal'

const grid = ref(true)
const formLayout = ref<string>(LAYOUT_TYPE_HORIZONTAL)

const formItems: ProFormItemType[] = [
  {
    name: 'layout',
    title: 'æ ‡ç­¾å¸ƒå±€',
    fieldType: ProFieldType.RADIO_GROUP,
    options: ['horizontal', 'vertical'],
    initialValue: formLayout.value,
    colProps: {
      span: 20,
    },
    fieldProps: {
      optionType: 'button',
    },
    onChange: (val) => {
      formLayout.value = val
    },
  },
  {
    name: 'grid',
    title: 'gridå¼€å…³',
    fieldType: ProFieldType.SWITCH,
    options: ['horizontal', 'vertical'],
    initialValue: true,
    colProps: {
      span: 4,
    },
    onChange: (val) => {
      grid.value = val
    },
  },
  {
    name: 'name',
    title: 'æ ‡é¢˜',
    tooltip: 'æœ€é•¿ä¸º 24 ä½',
    placeholder: 'è¯·è¾“å…¥åç§°',
  },
  {
    name: 'company',
    title: 'å§“å',
    colProps: {
      md: 12,
      xl: 8,
    },
  },
  {
    name: 'phone',
    title: 'ç”µè¯',
    colProps: {
      md: 12,
      xl: 8,
    },
  },
  {
    name: 'email',
    title: 'é‚®ç®±',
    colProps: {
      md: 12,
      xl: 8,
    },
  },
  {
    name: 'address',
    title: 'è¯¦ç»†çš„å·¥ä½œåœ°å€æˆ–å®¶åº­ä½å€',
    fieldType: ProFieldType.TEXTAREA,
    colProps: {
      span: 24,
    },
  },
]

const fetchDetail = async (params) => {
  console.log('ğŸš€ ~ request: ~ params:', params)
  await sleep(1500)
  return {
    name: 'Pro Design æœ‰é™å…¬å¸',
    useMode: 'chapter',
  }
}

const handleFinish = async (val) => {
  await sleep(2000)
  console.log(val)
  message.success('æäº¤æˆåŠŸ')
}
</script>

<template>
  <ProForm
    :grid="grid"
    :items="formItems"
    :layout="formLayout"
    :request="fetchDetail"
    :params="{ id: '100' }"
    @finish="handleFinish"
  >
  </ProForm>
</template>
